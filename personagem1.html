<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Personagem 1 - RA Funcional</title>
    
    <!-- A-Frame com CDN alternativo -->
    <script src="https://cdn.jsdelivr.net/npm/aframe@1.5.0/dist/aframe.min.js"></script>
    <!-- AR.js com CDN alternativo -->
    <script src="https://cdn.jsdelivr.net/npm/ar.js@3.4.0/aframe/build/aframe-ar.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000000;
            color: white;
            font-family: Arial, sans-serif;
            overflow: hidden;
            width: 100vw;
            height: 100vh;
        }
        
        #loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 1000;
            background: rgba(0,0,0,0.8);
            padding: 30px;
            border-radius: 20px;
            border: 2px solid #4285f4;
        }
        
        .start-btn {
            background: #4285f4;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            margin-top: 20px;
            cursor: pointer;
            font-size: 16px;
        }
        
        #camera-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 100;
        }
        
        /* Info panels */
        .info-panel {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.95);
            color: white;
            padding: 20px;
            border-radius: 15px;
            width: 90%;
            max-width: 400px;
            z-index: 1001;
            text-align: center;
            border: 2px solid #4285f4;
        }
        
        .close-btn {
            background: #ff4444;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            margin-top: 15px;
            cursor: pointer;
        }
        
        .error {
            color: #ff4444;
            margin-top: 10px;
            display: none;
        }
    </style>
</head>
<body>

<div id="loading">
    <h2>ðŸ“± REALIDADE AUMENTADA</h2>
    <p>Clique para ativar a cÃ¢mera e aponte para o marcador Hiro</p>
    <button class="start-btn" onclick="startAR()">ðŸŽ¬ INICIAR CÃ‚MERA</button>
    <div class="error" id="error-message"></div>
</div>

<div id="camera-container"></div>

<!-- PainÃ©is de InformaÃ§Ã£o -->
<div id="historia" class="info-panel">
    <h3>ðŸ“– HISTÃ“RIA</h3>
    <p>LÃºcio aprendeu a arte da invisibilidade para proteger seus amigos e familiares.</p>
    <button class="close-btn" onclick="hideInfo()">FECHAR</button>
</div>

<div id="idade" class="info-panel">
    <h3>ðŸŽ‚ IDADE</h3>
    <p>18 anos</p>
    <button class="close-btn" onclick="hideInfo()">FECHAR</button>
</div>

<div id="habilidade" class="info-panel">
    <h3>âš¡ HABILIDADE</h3>
    <p>Invisibilidade Total - 10 minutos</p>
    <button class="close-btn" onclick="hideInfo()">FECHAR</button>
</div>

<script>
// Elementos DOM
const loading = document.getElementById('loading');
const cameraContainer = document.getElementById('camera-container');
const errorMessage = document.getElementById('error-message');

// IniciAR RA
async function startAR() {
    try {
        loading.innerHTML = '<h2>ðŸ“· ATIVANDO CÃ‚MERA...</h2><p>Aguarde...</p>';
        
        // Verificar se tem permissÃ£o primeiro
        const stream = await navigator.mediaDevices.getUserMedia({ 
            video: { facingMode: 'environment' }
        });
        
        // Parar stream de teste
        stream.getTracks().forEach(track => track.stop());
        
        // Criar cena AR programaticamente
        createARScene();
        
    } catch (error) {
        console.error('Erro na cÃ¢mera:', error);
        showError('NÃ£o foi possÃ­vel acessar a cÃ¢mera. Verifique as permissÃµes.');
    }
}

function createARScene() {
    // Limpar container
    cameraContainer.innerHTML = '';
    
    // Criar cena manualmente
    const scene = document.createElement('a-scene');
    scene.setAttribute('embedded', '');
    scene.setAttribute('vr-mode-ui', 'enabled: false');
    scene.setAttribute('renderer', 'logarithmicDepthBuffer: true; colorManagement: true');
    scene.setAttribute('arjs', 'sourceType: webcam; debugUIEnabled: false');
    
    // Adicionar marcador
    const marker = document.createElement('a-marker');
    marker.setAttribute('type', 'pattern');
    marker.setAttribute('preset', 'hiro');
    
    // ConteÃºdo do marcador
    marker.innerHTML = `
        <a-entity position="0 0 0">
            <a-image 
                src="imagens/image1.png" 
                position="0 0.5 0" 
                width="1.2" 
                height="1.6"
                rotation="0 180 0"
            ></a-image>
        </a-entity>
    `;
    
    // Adicionar cÃ¢mera
    const camera = document.createElement('a-entity');
    camera.setAttribute('camera', '');
    
    // Montar cena
    scene.appendChild(marker);
    scene.appendChild(camera);
    cameraContainer.appendChild(scene);
    
    // Esconder loading quando carregar
    scene.addEventListener('loaded', () => {
        loading.style.display = 'none';
        console.log('âœ… RA carregada com sucesso!');
    });
}

function showInfo(type) {
    document.getElementById(type).style.display = 'block';
}

function hideInfo() {
    document.querySelectorAll('.info-panel').forEach(panel => {
        panel.style.display = 'none';
    });
}

function showError(message) {
    errorMessage.textContent = message;
    errorMessage.style.display = 'block';
    loading.querySelector('p').textContent = 'Clique para tentar novamente';
}

// Verificar se Ã© mobile
if (/Android|iPhone|iPad/i.test(navigator.userAgent)) {
    // Auto-iniciar em mobile apÃ³s 1s
    setTimeout(startAR, 1000);
}

console.log('ðŸ“± PÃ¡gina carregada - Pronta para RA');
</script>

</body>
</html>
